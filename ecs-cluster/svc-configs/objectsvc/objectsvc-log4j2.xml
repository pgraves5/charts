<?xml version="1.0" encoding="UTF-8"?>
<Configuration monitorInterval="60" shutdownHook="disable">
    <CustomLevels>
        <CustomLevel name="DEBUG_TREE" intLevel="520"/>
        <CustomLevel name="DEBUG_SYNC" intLevel="540"/>
        <CustomLevel name="DEBUG_PAGE" intLevel="560"/>
        <CustomLevel name="DEBUG_ALL" intLevel="580"/>
    </CustomLevels>

    <Appenders>
        <RollingFile name="R" fileName="${sys:product.home}/logs/objectsvc.log"
                     filePattern="${sys:product.home}/logs/objectsvc.log.%i.gz">
            <PatternLayout pattern="%d{ISO8601} [%t%X{apiRequestId}] %5p  %F (line %L) %m%n%ex"/>

            <Policies>
                <SizeBasedTriggeringPolicy size="50 MB"/>
            </Policies>
            <DefaultRolloverStrategy max="14"/> <!-- approx 50MB+(14*5MB) MB -->
        </RollingFile>

        <RollingFile name="P" fileName="${sys:product.home}/logs/objectsvc-perf-counter.log"
                     filePattern="${sys:product.home}/logs/objectsvc-perf-counter.log.%i.gz">
            <PatternLayout pattern="%d{ISO8601} %m%n"/>

            <Policies>
                <SizeBasedTriggeringPolicy size="10 MB"/>
            </Policies>
            <DefaultRolloverStrategy max="10"/> <!-- approx 10MB+(10*1.2MB) MB -->
        </RollingFile>

        <RollingFile name="AKKA_BFW" fileName="${sys:product.home}/logs/objectsvc-akkabfw.log"
                     filePattern="${sys:product.home}/logs/objectsvc-akkabfw.log.%i.gz">
            <PatternLayout pattern="%d{ISO8601} [%t%X{apiRequestId}] %X{akkaSource} %5p %c{1} %m%n%ex"/>

            <Policies>
                <SizeBasedTriggeringPolicy size="10 MB" />
            </Policies>
            <DefaultRolloverStrategy max="4"/> <!-- approx 10MB+(4*1.5MB) MB -->
        </RollingFile>

        <RollingFile name="DT" fileName="${sys:product.home}/logs/objectsvc-dt.log"
                     filePattern="${sys:product.home}/logs/objectsvc-dt.log.%i.gz">
            <PatternLayout pattern="%d{ISO8601} [%t%X{apiRequestId}] %5p  %F (line %L) %m%n%ex"/>

            <Policies>
                <SizeBasedTriggeringPolicy size="50 MB"/>
            </Policies>
            <DefaultRolloverStrategy max="8"/> <!-- approx 50MB+(9*2.3MB) MB -->
        </RollingFile>

        <Syslog name="alertsLogger" host="localhost" port="514" protocol="UDP" facility="LOCAL7"/>

        <Async name="asyncR" includeLocation="true">
            <AppenderRef ref="R"/>
        </Async>
        <Async name="asyncP">
            <AppenderRef ref="P"/>
        </Async>
        <Async name="asyncAkkaBfw" includeLocation="true">
            <AppenderRef ref="AKKA_BFW"/>
        </Async>
        <Async name="asyncDT" includeLocation="true">
            <AppenderRef ref="DT"/>
        </Async>
    </Appenders>

    <Loggers>
        <!-- btree ssd cache log -->
        <Logger name="com.emc.storageos.data.object.bplustree.BPlusTreeSSDCache" level="INFO">
            <AppenderRef ref="asyncDT"/>
        </Logger>
        <Logger name="com.emc.storageos.data.object.bplustree.BPlusTreeReadCache" level="INFO">
            <AppenderRef ref="asyncDT"/>
        </Logger>
        <Logger name="com.emc.storageos.data.object.bplustree.BPlusTreeCache" level="INFO">
            <AppenderRef ref="asyncDT"/>
        </Logger>
        <Logger name="com.emc.storageos.data.object.bplustree.rocksdb.ColumnFamilies" level="INFO">
            <AppenderRef ref="asyncDT"/>
        </Logger>

        <Logger name="com.emc.storageos.services.util.AlertsLogger"
                level="WARN" additivity="false">
            <AppenderRef ref="alertsLogger"/>
            <AppenderRef ref="asyncR" level="ERROR"/>
        </Logger>

        <Logger name="com.emc.storageos.objcontrol.object.shared.PerformanceCounter" level="DEBUG" additivity="false">
            <AppenderRef ref="asyncP"/>
            <AppenderRef ref="asyncR" level="ERROR"/>
        </Logger>

        <!-- ownership log -->
        <Logger name="com.emc.storageos.data.object.ownership.impl" level="INFO" additivity="false">
            <AppenderRef ref="asyncDT"/>
            <AppenderRef ref="asyncR" level="ERROR"/>
        </Logger>

        <!-- chunk-reclaim log -->
        <Logger name="com.dell.flex.object.impl.gc" level="DEBUG" additivity="false">
            <AppenderRef ref="asyncDT"/>
            <AppenderRef ref="asyncR" level="INFO"/>
        </Logger>
        <Logger name="com.emc.storageos.data.object.impl.gc" level="DEBUG" additivity="false">
            <AppenderRef ref="asyncDT"/>
            <AppenderRef ref="asyncR" level="ERROR"/>
        </Logger>
        <Logger name="com.emc.storageos.data.object.impl.gc.reference" level="INFO" additivity="false">
            <AppenderRef ref="asyncDT"/>
            <AppenderRef ref="asyncR" level="ERROR"/>
        </Logger>
        <Logger name="com.emc.storageos.data.object.impl.gc.RepositoryReferenceTable" level="INFO" additivity="false">
            <AppenderRef ref="asyncDT"/>
            <AppenderRef ref="asyncR" level="ERROR"/>
        </Logger>
        <Logger name="com.emc.storageos.data.object.bplustree.gc" level="INFO" additivity="false">
            <AppenderRef ref="asyncDT"/>
            <AppenderRef ref="asyncR" level="ERROR"/>
        </Logger>
        <Logger name="com.dell.flex.object.impl.gc.verification" level="DEBUG" additivity="false">
            <AppenderRef ref="asyncDT"/>
            <AppenderRef ref="asyncR" level="ERROR"/>
        </Logger>

        <!-- chunk lifecycle log -->
        <Logger name="com.emc.storageos.data.object.impl.gc.ChunkLifecycleLogger" level="INFO" additivity="false">
            <AppenderRef ref="asyncDT"/>
            <AppenderRef ref="asyncR" level="ERROR"/>
        </Logger>

        <!-- btree dump log -->
        <Logger name="com.emc.storageos.data.object.bplustree" level="INFO" additivity="false">
            <AppenderRef ref="asyncDT"/>
            <AppenderRef ref="asyncR" level="ERROR"/>
        </Logger>

        <!-- akka bfw log -->
        <Logger name="akka.actor" level="WARNING" additivity="false">
            <AppenderRef ref="AKKA_BFW"/>
        </Logger>
        <Logger name="com.emc.storageos.data.object.akkaimpl" level="INFO" additivity="false">
            <AppenderRef ref="asyncAkkaBfw"/>
            <AppenderRef ref="asyncR" level="ERROR"/>
        </Logger>

        <!-- refresh chunk cache log -->
        <Logger name="com.emc.storageos.data.object.client.ReportBlockErrorTask.refreshChunkInfo" level="WARN" additivity="false">
            <AppenderRef ref="asyncDT"/>
        </Logger>

        <!-- default log -->
        <Root level="INFO">
            <AppenderRef ref="asyncR"/>
        </Root>

        <!-- Turn down some noisy loggers by default -->
        <Logger name="org.perf4j.TimingLogger" level="ERROR"/>
        <Logger name="org.apache.http" level="WARN"/>
        <Logger name="com.emc.storageos.data.object.common.GeoClient$StaleConnectionMonitorThread" level="WARN"/>
        <Logger name="com.emc.storageos.data.object.impl.buffer.BufferManagerImpl" level="WARN"/>
        <Logger name="com.emc.storageos.data.object.impl.TaskScheduler" level="WARN"/>
        <Logger name="com.emc.storageos.data.object.utils.ConfigWatch" level="WARN"/>
        <Logger name="com.emc.storageos.data.object.utils.DataNodeAddressCache" level="WARN"/>
        <Logger name="com.emc.storageos.data.object.utils.VarrayValidityChecker" level="WARN"/>
        <Logger name="com.emc.storageos.data.object.utils.ZoneScannerImpl" level="WARN"/>
    </Loggers>
</Configuration>
